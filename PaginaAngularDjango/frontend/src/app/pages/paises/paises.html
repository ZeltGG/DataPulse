<h1>Paises</h1>

<div class="toolbar cardish">
  <input
    class="search"
    placeholder="Buscar por nombre, ISO o moneda..."
    [(ngModel)]="search"
    (ngModelChange)="applyFilters()"
  />

  <select class="select" [ngModel]="region" (ngModelChange)="onRegionChange($event)">
    <option value="">Todas las regiones</option>
    <option value="ANDINA">ANDINA</option>
    <option value="CONO_SUR">CONO_SUR</option>
    <option value="CENTROAMERICA">CENTROAMERICA</option>
    <option value="CARIBE">CARIBE</option>
  </select>

  <span class="count">Total: {{ count }}</span>
</div>

<p *ngIf="loading">Cargando...</p>
<p *ngIf="error" class="error">{{ error }}</p>

<table *ngIf="!loading && !error" class="table">
  <thead>
    <tr>
      <th>ISO</th>
      <th>Nombre</th>
      <th>Region</th>
      <th>Moneda</th>
      <th>Poblacion</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <tr *ngFor="let p of filtered">
      <td class="iso-cell">
        <app-country-flag [iso]="p.codigo_iso" [size]="20" [showCode]="true"></app-country-flag>
      </td>
      <td>{{ p.nombre }}</td>
      <td>{{ p.region }}</td>
      <td>{{ p.moneda_codigo }} - {{ p.moneda_nombre }}</td>
      <td>{{ p.poblacion }}</td>
      <td>
        <a [routerLink]="['/paises', p.codigo_iso]">Ver detalle</a>
      </td>
    </tr>
  </tbody>
</table>

<div *ngIf="!loading && !error" class="pager">
  <button (click)="goPrev()" [disabled]="!previous">Anterior</button>
  <span>Pagina {{ page }}</span>
  <button (click)="goNext()" [disabled]="!next">Siguiente</button>
</div>
